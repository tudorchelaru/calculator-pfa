---
// Calculator Taxe PFA conform documentaÈ›iei 2025-2026
---

<div class="calculator">
	<div class="input-section">
		<div class="input-group">
			<label for="an">
				<span>An</span>
				<select id="an" name="an">
					<option value="2026" selected>2026</option>
					<option value="2025">2025</option>
				</select>
			</label>

			<label for="salariat">
				<span>EÈ™ti salariat?</span>
				<select id="salariat" name="salariat">
					<option value="nu" selected>Nu</option>
					<option value="da">Da</option>
				</select>
			</label>
		</div>

		<label for="venit-brut">
			<span>Venit Brut Lunar (RON)</span>
			<input 
				type="number" 
				id="venit-brut" 
				name="venit-brut"
				value="0"
				min="0"
				step="100"
				placeholder="Ex: 10000"
			/>
			<small>Total Ã®ncasÄƒri lunare din activitatea PFA</small>
		</label>

		<label for="cheltuieli">
			<span>Cheltuieli Deductibile Lunar (RON)</span>
			<input 
				type="number" 
				id="cheltuieli" 
				name="cheltuieli"
				value="0"
				min="0"
				step="100"
				placeholder="Ex: 1000"
			/>
			<small>Costuri lunare necesare desfÄƒÈ™urÄƒrii activitÄƒÈ›ii</small>
		</label>

		<div class="info-box">
			<strong>Venit Net Anual:</strong> <span id="venit-net-preview">0 RON</span>
			<small>(Venit Brut Lunar - Cheltuieli Lunare) Ã— 12 luni</small>
		</div>
	</div>

	<div class="results-section">
		<div class="result-card">
			<span class="label">Venit Net Anual</span>
			<span class="value" id="venit-net">0 RON</span>
		</div>
		<div class="result-card">
			<span class="label">CAS (25%)</span>
			<span class="value" id="cas">0 RON</span>
			<span class="detail" id="cas-detail"></span>
		</div>
		<div class="result-card">
			<span class="label">CASS (10%)</span>
			<span class="value" id="cass">0 RON</span>
			<span class="detail" id="cass-detail"></span>
		</div>
		<div class="result-card">
			<span class="label">Impozit pe Venit (10%)</span>
			<span class="value" id="impozit">0 RON</span>
			<span class="detail" id="impozit-detail"></span>
		</div>
		<div class="result-card total">
			<span class="label">Total Taxe</span>
			<span class="value" id="total-taxe">0 RON</span>
		</div>
		<div class="result-card net">
			<span class="label">Venit Net DupÄƒ Taxe (Anual)</span>
			<span class="value" id="venit-final">0 RON</span>
		</div>
		<div class="result-card final-monthly highlight">
			<span class="label">ðŸ’° RÄƒmÃ¢ne Ã®n Buzunar pe LunÄƒ</span>
			<span class="value" id="venit-lunar-final">0 RON</span>
			<span class="subtitle">DupÄƒ toate taxele È™i cheltuielile</span>
		</div>
		<div class="result-card rate">
			<span class="label">Rata EfectivÄƒ de Impozitare</span>
			<span class="value" id="rata-efectiva">0%</span>
		</div>
	</div>

	<div class="praguri-section">
		<h3>Praguri pentru anul selectat</h3>
		<div class="praguri-grid" id="praguri-info"></div>
	</div>
</div>

<script>
	// Constante pentru salarii minime
	const SALARIU_MINIM = {
		2025: 3300,
		2026: 4050
	};

	// Elemente DOM
	const anSelect = document.getElementById('an') as HTMLSelectElement;
	const salariatSelect = document.getElementById('salariat') as HTMLSelectElement;
	const venitBrutInput = document.getElementById('venit-brut') as HTMLInputElement;
	const cheltuieliInput = document.getElementById('cheltuieli') as HTMLInputElement;
	const venitNetPreview = document.getElementById('venit-net-preview') as HTMLElement;
	const praguriInfo = document.getElementById('praguri-info') as HTMLElement;

	// FuncÈ›ii de calcul conform documentaÈ›iei

	function calculCAS(venitNet: number, an: number): { valoare: number; detalii: string } {
		const sm = SALARIU_MINIM[an as keyof typeof SALARIU_MINIM];
		const prag12SM = 12 * sm;
		const prag24SM = 24 * sm;

		if (venitNet <= prag12SM) {
			return {
				valoare: 0,
				detalii: `Sub 12 SM (${formatNumber(prag12SM)} RON) â†’ CAS = 0`
			};
		}

		if (venitNet <= prag24SM) {
			const cas = 0.25 * prag12SM;
			return {
				valoare: cas,
				detalii: `ÃŽntre 12-24 SM â†’ CAS = 25% Ã— 12 SM = ${formatCurrency(cas)}`
			};
		}

		const cas = 0.25 * prag24SM;
		return {
			valoare: cas,
			detalii: `Peste 24 SM (${formatNumber(prag24SM)} RON) â†’ CAS = 25% Ã— 24 SM = ${formatCurrency(cas)} (plafon)`
		};
	}

	function calculCASS(venitNet: number, an: number, esteSalariat: boolean): { valoare: number; detalii: string } {
		const sm = SALARIU_MINIM[an as keyof typeof SALARIU_MINIM];
		const prag6SM = 6 * sm;
		const prag60SM = 60 * sm;

		// Sub 6 SM
		if (venitNet < prag6SM) {
			if (esteSalariat) {
				const cass = 0.10 * venitNet;
				return {
					valoare: cass,
					detalii: `Sub 6 SM, salariat â†’ CASS = 10% Ã— venit net = ${formatCurrency(cass)} (fÄƒrÄƒ minim)`
				};
			} else {
				const cassMinim = 0.10 * prag6SM;
				return {
					valoare: cassMinim,
					detalii: `Sub 6 SM, nesalariat â†’ CASS minim = 10% Ã— 6 SM = ${formatCurrency(cassMinim)}`
				};
			}
		}

		// ÃŽntre 6-60 SM
		if (venitNet <= prag60SM) {
			const cass = 0.10 * venitNet;
			return {
				valoare: cass,
				detalii: `ÃŽntre 6-60 SM â†’ CASS = 10% Ã— venit net = ${formatCurrency(cass)}`
			};
		}

		// Peste 60 SM
		const cassPlafon = 0.10 * prag60SM;
		return {
			valoare: cassPlafon,
			detalii: `Peste 60 SM (${formatNumber(prag60SM)} RON) â†’ CASS plafon = 10% Ã— 60 SM = ${formatCurrency(cassPlafon)}`
		};
	}

	function calculImpozit(venitNet: number, cas: number, cass: number): { valoare: number; detalii: string } {
		const bazaImpozit = Math.max(0, venitNet - cas - cass);
		const impozit = 0.10 * bazaImpozit;

		if (bazaImpozit === 0) {
			return {
				valoare: 0,
				detalii: `Baza impozit = venit net - CAS - CASS = ${formatNumber(venitNet)} - ${formatNumber(cas)} - ${formatNumber(cass)} = 0 (nu poate fi negativÄƒ)`
			};
		}

		return {
			valoare: impozit,
			detalii: `Baza = ${formatNumber(venitNet)} - ${formatNumber(cas)} - ${formatNumber(cass)} = ${formatNumber(bazaImpozit)} â†’ Impozit = 10% Ã— ${formatNumber(bazaImpozit)} = ${formatCurrency(impozit)}`
		};
	}

	function updatePraguri(an: number) {
		const sm = SALARIU_MINIM[an as keyof typeof SALARIU_MINIM];
		const prag6SM = 6 * sm;
		const prag12SM = 12 * sm;
		const prag24SM = 24 * sm;
		const prag60SM = 60 * sm;

		praguriInfo.innerHTML = `
			<div class="prag-item">
				<strong>6 SM</strong>
				<span>${formatCurrency(prag6SM)}</span>
				<small>Minim CASS (nesalariaÈ›i)</small>
			</div>
			<div class="prag-item">
				<strong>12 SM</strong>
				<span>${formatCurrency(prag12SM)}</span>
				<small>Prag minim CAS</small>
			</div>
			<div class="prag-item">
				<strong>24 SM</strong>
				<span>${formatCurrency(prag24SM)}</span>
				<small>Plafon CAS</small>
			</div>
			<div class="prag-item">
				<strong>60 SM</strong>
				<span>${formatCurrency(prag60SM)}</span>
				<small>Plafon CASS</small>
			</div>
		`;
	}

	function updateCalculations() {
		const an = parseInt(anSelect.value);
		const esteSalariat = salariatSelect.value === 'da';
		const venitBrutLunar = parseFloat(venitBrutInput.value) || 0;
		const cheltuieliLunare = parseFloat(cheltuieliInput.value) || 0;
		
		// CalculÄƒm anual
		const venitBrutAnual = venitBrutLunar * 12;
		const cheltuieliAnuale = cheltuieliLunare * 12;
		const venitNet = Math.max(0, venitBrutAnual - cheltuieliAnuale);

		// Update preview
		venitNetPreview.textContent = formatCurrency(venitNet);

		// Calcule
		const casResult = calculCAS(venitNet, an);
		const cassResult = calculCASS(venitNet, an, esteSalariat);
		const impozitResult = calculImpozit(venitNet, casResult.valoare, cassResult.valoare);

		const totalTaxe = casResult.valoare + cassResult.valoare + impozitResult.valoare;
		const venitFinalAnual = venitNet - totalTaxe;
		const venitFinalLunar = venitFinalAnual / 12;
		const rataEfectiva = venitNet > 0 ? (totalTaxe / venitNet) * 100 : 0;

		// Update UI
		(document.getElementById('venit-net-preview') as HTMLElement).textContent = formatCurrency(venitNet);
		(document.getElementById('venit-net') as HTMLElement).textContent = formatCurrency(venitNet);
		(document.getElementById('cas') as HTMLElement).textContent = formatCurrency(casResult.valoare);
		(document.getElementById('cas-detail') as HTMLElement).textContent = casResult.detalii;
		(document.getElementById('cass') as HTMLElement).textContent = formatCurrency(cassResult.valoare);
		(document.getElementById('cass-detail') as HTMLElement).textContent = cassResult.detalii;
		(document.getElementById('impozit') as HTMLElement).textContent = formatCurrency(impozitResult.valoare);
		(document.getElementById('impozit-detail') as HTMLElement).textContent = impozitResult.detalii;
		(document.getElementById('total-taxe') as HTMLElement).textContent = formatCurrency(totalTaxe);
		(document.getElementById('venit-final') as HTMLElement).textContent = formatCurrency(venitFinalAnual);
		(document.getElementById('venit-lunar-final') as HTMLElement).textContent = formatCurrency(venitFinalLunar);
		(document.getElementById('rata-efectiva') as HTMLElement).textContent = `${rataEfectiva.toFixed(2)}%`;

		// Update praguri
		updatePraguri(an);
	}

	function formatCurrency(value: number): string {
		return new Intl.NumberFormat('ro-RO', {
			style: 'currency',
			currency: 'RON',
			minimumFractionDigits: 2,
			maximumFractionDigits: 2
		}).format(value);
	}

	function formatNumber(value: number): string {
		return new Intl.NumberFormat('ro-RO', {
			minimumFractionDigits: 0,
			maximumFractionDigits: 0
		}).format(value);
	}

	// Event listeners
	anSelect.addEventListener('change', updateCalculations);
	salariatSelect.addEventListener('change', updateCalculations);
	venitBrutInput.addEventListener('input', updateCalculations);
	cheltuieliInput.addEventListener('input', updateCalculations);

	// Initial calculation
	updateCalculations();
</script>

<style>
	.calculator {
		display: flex;
		flex-direction: column;
		gap: 2rem;
	}

	.input-section {
		display: flex;
		flex-direction: column;
		gap: 1.5rem;
	}

	.input-group {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: 1rem;
	}

	label {
		display: flex;
		flex-direction: column;
		gap: 0.5rem;
	}

	label span {
		font-weight: 600;
		color: #333;
		font-size: 0.95rem;
	}

	label small {
		font-size: 0.85rem;
		color: #666;
		margin-top: 0.25rem;
	}

	input[type="number"],
	select {
		padding: 0.75rem 1rem;
		border: 2px solid #e0e0e0;
		border-radius: 8px;
		font-size: 1rem;
		transition: border-color 0.2s;
	}

	input[type="number"]:focus,
	select:focus {
		outline: none;
		border-color: #667eea;
	}

	.info-box {
		background: #f0f4ff;
		border: 2px solid #667eea;
		border-radius: 8px;
		padding: 1rem;
		display: flex;
		flex-direction: column;
		gap: 0.25rem;
	}

	.info-box strong {
		color: #667eea;
		font-size: 1.1rem;
	}

	.info-box small {
		color: #666;
		font-size: 0.85rem;
	}

	.results-section {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
		gap: 1rem;
		margin-top: 1rem;
	}

	.result-card {
		background: #f8f9fa;
		padding: 1.5rem;
		border-radius: 12px;
		display: flex;
		flex-direction: column;
		gap: 0.5rem;
		border: 2px solid transparent;
		transition: all 0.2s;
	}

	.result-card:hover {
		border-color: #667eea;
		transform: translateY(-2px);
		box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
	}

	.result-card.total {
		background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
		color: white;
		grid-column: 1 / -1;
	}

	.result-card.net {
		background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
		color: white;
		grid-column: 1 / -1;
	}

	.result-card.rate {
		background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
		color: white;
		grid-column: 1 / -1;
	}

	.result-card.highlight {
		background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
		color: white;
		grid-column: 1 / -1;
		border: 3px solid #ff9500;
		box-shadow: 0 8px 24px rgba(255, 149, 0, 0.3);
	}

	.result-card.highlight .value {
		font-size: 2.5rem;
	}

	.result-card.highlight .subtitle {
		font-size: 0.9rem;
		opacity: 0.95;
		margin-top: 0.5rem;
		font-weight: 500;
	}

	.result-card .label {
		font-size: 0.9rem;
		opacity: 0.9;
		font-weight: 500;
	}

	.result-card .value {
		font-size: 1.5rem;
		font-weight: 700;
	}

	.result-card.total .value,
	.result-card.net .value,
	.result-card.rate .value {
		font-size: 2rem;
	}

	.result-card .detail {
		font-size: 0.75rem;
		opacity: 0.7;
		margin-top: 0.5rem;
		line-height: 1.4;
	}

	.result-card.total .detail,
	.result-card.net .detail,
	.result-card.rate .detail {
		opacity: 0.9;
	}

	.praguri-section {
		margin-top: 2rem;
		padding-top: 2rem;
		border-top: 2px solid #e0e0e0;
	}

	.praguri-section h3 {
		margin-bottom: 1rem;
		color: #333;
		font-size: 1.2rem;
	}

	.praguri-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
		gap: 1rem;
	}

	.prag-item {
		background: #f8f9fa;
		padding: 1rem;
		border-radius: 8px;
		display: flex;
		flex-direction: column;
		gap: 0.5rem;
		border: 2px solid #e0e0e0;
	}

	.prag-item strong {
		color: #667eea;
		font-size: 1.1rem;
	}

	.prag-item span {
		font-size: 1.2rem;
		font-weight: 700;
		color: #333;
	}

	.prag-item small {
		font-size: 0.8rem;
		color: #666;
	}

	@media (max-width: 768px) {
		.input-group {
			grid-template-columns: 1fr;
		}

		.results-section {
			grid-template-columns: 1fr;
		}

		.result-card.total,
		.result-card.net,
		.result-card.rate,
		.result-card.highlight {
			grid-column: 1;
		}

		.praguri-grid {
			grid-template-columns: 1fr;
		}
	}
</style>
